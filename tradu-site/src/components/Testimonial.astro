---
const testimonials = [
  {
    name: "Juan M.",
    role: "Estudiante becado",
    text: "Me entregaron la traducción súper rápido y sin errores. Pude enviar mis documentos a tiempo para la beca.",
  },
  {
    name: "María P.",
    role: "Trámite de visa Reino Unido",
    text: "La embajada de Inglaterra aceptó mis documentos sin ningún problema. El proceso fue claro y profesional.",
  },
  {
    name: "Carlos R.",
    role: "Documentos corporativos",
    text: "Traducción muy cuidadosa con los términos legales. Se nota que está revisado por profesionales.",
  },
  {
    name: "Sofía L.",
    role: "Aplicación a maestría",
    text: "Usé sus traducciones para un posgrado en el extranjero. Todo llegó a tiempo y con los sellos requeridos.",
  },
];
---

<section class="py-20 bg-[var(--background-color)]">
  <div class="max-w-4xl mx-auto px-6">
    <header class="text-center max-w-3xl mx-auto mb-10">
  <!-- Eyebrow -->
  <div
    class="inline-flex items-center justify-center px-4 py-1.5 rounded-full
           bg-[var(--brand-primary)]/10 text-[var(--brand-primary)]
           text-xs font-semibold tracking-wide uppercase mb-3">
    Opiniones verificadas
  </div>

  <!-- Main heading -->
  <h2
    class="text-2xl md:text-4xl font-bold text-[var(--brand-black)] leading-tight">
    Lo que nuestros clientes dicen sobre nuestras traducciones
  </h2>

  <!-- Subheading -->
  <p class="mt-3 text-sm md:text-base text-slate-600 leading-relaxed">
    Más de 1,000 documentos traducidos y aceptados por universidades, embajadas y entidades legales.
    La precisión, rapidez y confiabilidad son lo que más destacan nuestros clientes.
  </p>
</header>
    <!-- Carrusel -->
    <div class="relative min-h-[210px] md:min-h-[230px]">
      {testimonials.map((item, index) => (
        <article
          class={`testimonial-slide absolute inset-0 flex flex-col items-center justify-center text-center transition-all duration-500
            ${index === 0
              ? "opacity-100 translate-y-0"
              : "opacity-0 translate-y-3 pointer-events-none"
            }`}
          data-index={index}
        >
          <!-- Cita -->
          <p
            class="text-[1.3rem] md:text-[1.6rem] lg:text-[1.8rem]
                   leading-snug md:leading-snug text-[var(--brand-black)]
                   max-w-3xl font-medium"
          >
            “{item.text}”
          </p>

          <!-- Nombre y rol -->
          <div class="mt-6 text-xs md:text-sm text-slate-500">
            <p class="font-semibold text-[var(--brand-black)]">
              {item.name}
            </p>
            <p class="mt-0.5">
              {item.role}
            </p>
          </div>
        </article>
      ))}
    </div>

    <!-- Líneas / indicadores -->
    <div class="mt-8 flex justify-center gap-4">
      {testimonials.map((_, index) => (
        <button
          type="button"
          class={`testimonial-indicator h-[2px] w-10 md:w-14 rounded-full transition
            ${index === 0
              ? "bg-[var(--brand-primary)]"
              : "bg-slate-300"
            }`}
          data-index={index}
          aria-label={`Ver testimonio ${index + 1}`}
        ></button>
      ))}
    </div>
  </div>

  <!-- Script del carrusel -->
  <script is:inline>
    const slides = document.querySelectorAll(".testimonial-slide");
    const indicators = document.querySelectorAll(".testimonial-indicator");

    if (slides.length && indicators.length) {
      let current = 0;
      let intervalId;

      const showSlide = (newIndex) => {
        // ocultar actual
        slides[current].classList.add("opacity-0", "translate-y-3", "pointer-events-none");
        slides[current].classList.remove("opacity-100", "translate-y-0");

        indicators[current].classList.remove("bg-[var(--brand-primary)]");
        indicators[current].classList.add("bg-slate-300");

        // mostrar nuevo
        slides[newIndex].classList.remove("opacity-0", "translate-y-3", "pointer-events-none");
        slides[newIndex].classList.add("opacity-100", "translate-y-0");

        indicators[newIndex].classList.add("bg-[var(--brand-primary)]");
        indicators[newIndex].classList.remove("bg-slate-300");

        current = newIndex;
      };

      const startAutoPlay = () => {
        intervalId = setInterval(() => {
          const next = (current + 1) % slides.length;
          showSlide(next);
        }, 6000); // 6s
      };

      const resetAutoPlay = () => {
        clearInterval(intervalId);
        startAutoPlay();
      };

      // click en las líneas
      indicators.forEach((indicator) => {
        indicator.addEventListener("click", () => {
          const targetIndex = Number(indicator.dataset.index);
          if (targetIndex !== current) {
            showSlide(targetIndex);
            resetAutoPlay();
          }
        });
      });

      startAutoPlay();
    }
  </script>
</section>
