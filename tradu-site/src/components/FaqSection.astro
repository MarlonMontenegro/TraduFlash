---
interface Props {
  lang: "es" | "en";
  t: any;
}

const { t } = Astro.props;
---

<section id="faq" class="relative py-24" data-aos>
  <!-- DOTS BACKGROUND -->
  <div
    class="absolute inset-0 pointer-events-none
           [background-image:radial-gradient(#c7c7c7_1px,transparent_1px)]
           [background-size:18px_18px]
           opacity-40"
  ></div>

  <!-- CONTENT WRAPPER -->
  <div class="relative max-w-4xl mx-auto px-6">
    <!-- TITLE -->
    <h2
      class="text-3xl md:text-4xl font-bold text-[var(--brand-black)] mb-12"
      data-aos-item
    >
      {t.faq.title}
    </h2>

    <!-- FAQ LIST -->
    <div class="space-y-4">
      {t.faq.items.map((item) => (
        <div
          x-data="{ open: false }"
          class="border-b border-slate-300 pb-4"
          data-aos-item
        >
          <!-- QUESTION -->
          <button
            @click="open = !open"
            class="w-full flex justify-between items-center text-left gap-4"
          >
            <span class="text-lg font-medium text-[var(--brand-black)]">
              {item.question}
            </span>

            <span
              class="text-2xl font-light transition-transform duration-200 shrink-0"
              :class="open ? 'rotate-45' : ''"
            >
              +
            </span>
          </button>

          <!-- ANSWER -->
          <div
            x-show="open"
            x-collapse
            class="mt-3 text-slate-600 leading-relaxed text-base"
          >
            {item.answer}
          </div>
        </div>
      ))}
    </div>
  </div>

  <!-- ================== AOS STYLE ================== -->
  <style>
    [data-aos-item] {
      opacity: 0;
      transform: translateY(14px) scale(0.995);
      filter: blur(6px);
      transition:
        opacity 700ms cubic-bezier(0.22, 1, 0.36, 1),
        transform 700ms cubic-bezier(0.22, 1, 0.36, 1),
        filter 700ms cubic-bezier(0.22, 1, 0.36, 1);
      will-change: opacity, transform, filter;
    }

    [data-aos].is-inview [data-aos-item] {
      opacity: 1;
      transform: translateY(0) scale(1);
      filter: blur(0);
    }

    [data-aos].is-inview [data-aos-item]:nth-child(1) {
      transition-delay: 0ms;
    }
    [data-aos].is-inview [data-aos-item]:nth-child(2) {
      transition-delay: 110ms;
    }
    [data-aos].is-inview [data-aos-item]:nth-child(3) {
      transition-delay: 220ms;
    }
    [data-aos].is-inview [data-aos-item]:nth-child(4) {
      transition-delay: 330ms;
    }
    [data-aos].is-inview [data-aos-item]:nth-child(5) {
      transition-delay: 440ms;
    }
    [data-aos].is-inview [data-aos-item]:nth-child(6) {
      transition-delay: 550ms;
    }
    [data-aos].is-inview [data-aos-item]:nth-child(7) {
      transition-delay: 660ms;
    }
    [data-aos].is-inview [data-aos-item]:nth-child(8) {
      transition-delay: 770ms;
    }
    [data-aos].is-inview [data-aos-item]:nth-child(9) {
      transition-delay: 880ms;
    }
    [data-aos].is-inview [data-aos-item]:nth-child(10) {
      transition-delay: 990ms;
    }

    @media (prefers-reduced-motion: reduce) {
      [data-aos-item] {
        transition: none !important;
        opacity: 1 !important;
        transform: none !important;
        filter: none !important;
      }
    }
  </style>

  <!-- ================== AOS SCRIPT ================== -->
  <script is:inline>
    const initAOS = () => {
      const sections = document.querySelectorAll("[data-aos]");
      if (!sections.length) return;

      const io = new IntersectionObserver(
        (entries) => {
          entries.forEach((entry) => {
            entry.target.classList.toggle("is-inview", entry.isIntersecting);
          });
        },
        { threshold: 0.18, rootMargin: "0px 0px -10% 0px" }
      );

      sections.forEach((sec) => io.observe(sec));
    };

    document.addEventListener("DOMContentLoaded", initAOS);
    document.addEventListener("astro:page-load", initAOS);
  </script>
</section>
