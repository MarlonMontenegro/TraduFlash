---
interface Step {
  title: string;
  description: string;
}

interface Props {
  lang: "en" | "es";
  t: any;
}

const { lang, t } = Astro.props;

const content = t.liveHowItWorks;
const steps = content.steps as Step[];
---

<style is:global>
  .fade-up {
    opacity: 0;
    transform: translateY(18px);
    transition: all 0.7s ease-out;
  }

  .fade-up.is-visible {
    opacity: 1;
    transform: translateY(0);
  }
</style>

<section
  class="relative py-20 px-4 bg-[var(--background-color)] overflow-hidden"
>
  <!-- Fondo de puntos -->
  <div
    class="absolute inset-0 z-0 opacity-[0.25]
           [background-size:18px_18px]
           [background-image:radial-gradient(#d8d8d8_1px,transparent_1px)]"
  ></div>

  <div class="relative z-10 max-w-6xl mx-auto">
    <!-- TÍTULO -->
    <div class="text-center mb-10 fade-up">
      <h2 class="text-3xl md:text-4xl font-bold text-[var(--brand-black)]">
        {content.title}
      </h2>
      {content.subtitle && (
        <p
          class="mt-3 text-sm md:text-base text-slate-600 max-w-2xl mx-auto leading-relaxed"
        >
          {content.subtitle}
        </p>
      )}
    </div>

    <!-- GRID STEPS -->
    <div class="grid gap-5 md:grid-cols-4">
      {steps.map((step, index) => (
        <article
          class="fade-up bg-white rounded-3xl border border-slate-200 shadow-sm
                 px-6 py-7 flex flex-col gap-3 text-left
                 transition-all duration-200 hover:-translate-y-1 hover:shadow-lg"
        >
          {/* Número */}
          <p class="text-2xl font-extrabold text-[var(--brand-primary)] mb-1">
            {String(index + 1).padStart(2, "0")}
          </p>

          {/* Título paso */}
          <h3 class="text-base md:text-lg font-semibold text-[var(--brand-black)]">
            {step.title}
          </h3>

          {/* Descripción */}
          <p class="text-sm md:text-sm text-slate-600 leading-relaxed">
            {step.description}
          </p>
        </article>
      ))}
    </div>
  </div>
</section>

<script>
  const observer = new IntersectionObserver(
    (entries) => {
      entries.forEach((entry) => {
        if (entry.isIntersecting) {
          entry.target.classList.add("is-visible");
        } else {
          // para que la animación se repita cada vez que entra
          entry.target.classList.remove("is-visible");
        }
      });
    },
    { threshold: 0.18 }
  );

  document.querySelectorAll(".fade-up").forEach((el) => observer.observe(el));
</script>
